<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Easy CPC-Based Queries of the PatentsView API • patentsview2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Easy CPC-Based Queries of the PatentsView API">
<meta property="og:description" content='Provides functions that make it easy to query the PatentsView API by CPC. The main function, patents_view(cpc="CPC#"), pulls a fixed set of fields for patents with a given CPC. Patents are only pulled if they have an application date after or on January 1, 2000. Patents are only pulled if the applicant is US-based. The function creates a flat file of patent information including: Patent number, title, abstract, granted date, inventor and assignee information, and other CPCs assigned'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">patentsview2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="patentsview2">patentsview2<a class="anchor" aria-label="anchor" href="#patentsview2"></a>
</h1></div>
<p><code>patentsview2</code> is a simple set of functions to query the <a href="https://search.patentsview.org/docs/docs/Search%20API/EndpointDictionary/#patent" class="external-link">Patent endpoint</a> of the <a href="https://patentsview.org/" class="external-link">PatentsView API</a> using <a href="https://en.wikipedia.org/wiki/Cooperative_Patent_Classification" class="external-link">CPC Subclass</a> identifiers (e.g. <a href="https://www.uspto.gov/web/patents/classification/cpc/html/cpc-G16H.html#G16H" class="external-link">G16H for medical informatics</a>).</p>
<p>As promised, this package was reworked to use the new version of the Patentsview API (renamed the PatentSearch API, as announced <a href="https://search.patentsview.org/docs/#naming-update" class="external-link">here</a>). We’re also using the <a href="https://mustberuss.github.io/patentsview/" class="external-link">updated patentview R package</a> though it’s not on CRAN yet.</p>
</div>
<div class="section level1">
<h1 id="introduction">introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h1>
<p>Patents and patent applications are a valuable measure of innovation within countries, sub-national geographies (e.g. states or cities), industries, and firms. Numerous patent databases exist, including <a href="https://data.epo.org/expert-services/index.html" class="external-link">PATSTAT from the EPO</a>, <a href="https://www.nber.org/research/data/us-patents" class="external-link">NBER</a>, <a href="https://patents.google.com/" class="external-link">Google Patents</a>, <a href="https://www.oecd.org/sti/intellectual-property-statistics-and-analysis.htm" class="external-link">OECD Patent Microdata</a>, <a href="https://www.uspto.gov/patents/search" class="external-link">the USPTO</a>, and <a href="https://iii.pubpub.org/datasets" class="external-link">others</a>. These databases can be unweildy, so the USPTO created <a href="https://patentsview.org/" class="external-link">PatentsView</a> as a user-friendly query portal for data about individual patents. They also implemented several API endpoints that can be queried directly. Despite its public availability and documentation, the PatentsView API isn’t <em>that</em> easy to use. So to collect data about patents across different patent types, classified by Cooperative Patent Classification (CPC) subclasses, I wrote a few helper functions. Hope they’re useful.</p>
</div>
<div class="section level1">
<h1 id="installation-steps">installation steps<a class="anchor" aria-label="anchor" href="#installation-steps"></a>
</h1>
<ol style="list-style-type: decimal">
<li><p>API team now requires an API key so you’ll need to <a href="https://patentsview-support.atlassian.net/servicedesk/customer/portals" class="external-link">request one</a> before any of this will work. The new version of the patentsview R package looks for its value in the environmental variable PATENTSVIEW_API_KEY. Please be careful when posting scripts to not include the value of your API key.</p></li>
<li>
<p>Install the new version of the Patentsview R package from r-universe</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"patentsview"</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://mustberuss.r-universe.dev"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p>Install the dev version of this package, patentsview2, from github</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"devtools"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nateapathy/patentsview2"</span><span class="op">)</span></span></code></pre></div>
</li>
</ol>
</div>
<div class="section level1">
<h1 id="the-patents_view-function">the <code>patents_view()</code> function<a class="anchor" aria-label="anchor" href="#the-patents_view-function"></a>
</h1>
<p><code><a href="reference/patents_view.html">patentsview2::patents_view()</a></code> is the primary function. This function calls two other functions, <code><a href="reference/pv_post.html">pv_post()</a></code> and <code><a href="reference/clean_patents.html">clean_patents()</a></code>. This function has a single argument, <code>cpc</code>, which takes a string consisting of any of the 4-character CPC subclasses available in PatentsView. By default, the function returns all patent applications with the defined classification since Jan 1, 2001 to the USPTO by US-based assignees. The earliest patent application in the database is 200100000012</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">patentsview2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/patents_view.html">patents_view</a></span><span class="op">(</span>cpc <span class="op">=</span> <span class="st">"F03B"</span><span class="op">)</span></span></code></pre></div>
<p>This returns a data frame of patent application observations and 30 fields of information about the patent as well as the inventors and assignees.</p>
<div class="section level2">
<h2 id="pv_post-and-clean_patents">
<code>pv_post()</code> and <code>clean_patents()</code>
<a class="anchor" aria-label="anchor" href="#pv_post-and-clean_patents"></a>
</h2>
<p>You should not have to call either of these functions directly. Both are called by <code><a href="reference/patents_view.html">patents_view()</a></code> to help with constructing the POST call to the API and to clean up the data frame, as their names imply.</p>
</div>
</div>
<div class="section level1">
<h1 id="the-cpc-datasets">the CPC datasets<a class="anchor" aria-label="anchor" href="#the-cpc-datasets"></a>
</h1>
<p>The package also includes two data sets for reference to CPC subclasses. <code>cpc_subgroups</code> lists all subclasses, groups, and subgroups (258,827 observations), while <code>cpc_subclasses</code> lists only the four-character subclass codes (615 observations) that can be used in the <code>cpc</code> argument within <code><a href="reference/patents_view.html">patents_view()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"cpc_subclasses"</span><span class="op">)</span> <span class="co"># 615 obs by 2 vars</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"cpc_subgroups"</span><span class="op">)</span> <span class="co"># 258,827 obs by 5 vars</span></span></code></pre></div>
<p>Use <code>cpc_subclasses</code> to find subclasses of interest, and use the 4-character code found in the <code>cpc_subclass</code> field in your query. You can also <a href="https://www.uspto.gov/web/patents/classification/cpc/html/cpc.html" class="external-link">browse the CPC hierarchy from the USPTO</a>. You may also want to loop through several CPC subclasses, as below. Note that the below code does not look for patents with all subclasses, but rather performs distinct API calls for each of the 5 random CPC subclasses sampled. In this case, the 5 data frames will all be in the <code>random_cpcs</code> list.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># random sample of CPCs</span></span>
<span><span class="va">cpc_samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">cpc_subclasses</span><span class="op">$</span><span class="va">cpc_subclass</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">random_cpcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cpc_samp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">random_cpcs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/patents_view.html">patents_view</a></span><span class="op">(</span>cpc <span class="op">=</span> <span class="va">cpc_samp</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">random_cpcs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">cpc_samp</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="an-example">an example<a class="anchor" aria-label="anchor" href="#an-example"></a>
</h1>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CPC Subclass B62K: Unicycles</span></span>
<span><span class="va">cpc_subclasses</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cpc_subclass</span> <span class="op">==</span> <span class="st">"B62K"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   cpc_subclass     title</span></span>
<span><span class="co">#&gt; 1         B62K Unicycles</span></span>
<span><span class="va">b62k</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/patents_view.html">patents_view</a></span><span class="op">(</span>cpc <span class="op">=</span> <span class="st">"B62K"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">b62k</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2668   42</span></span>
<span><span class="co"># patent applications since Jan 1 2000</span></span>
<span></span>
<span><span class="co"># get number of unique patient numbers</span></span>
<span><span class="co"># remember, each observation is an APPLICATION not a patent</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">b62k</span><span class="op">$</span><span class="va">patent_number</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="co"># how many unique first assignees?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">b62k</span><span class="op">$</span><span class="va">assignee_organization</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 17</span></span>
<span></span>
<span><span class="co"># what other fields do we have?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">b62k</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "patent_id"                                                   </span></span>
<span><span class="co">#&gt;  [2] "patent_title"                                                </span></span>
<span><span class="co">#&gt;  [3] "patent_type"                                                 </span></span>
<span><span class="co">#&gt;  [4] "patent_date"                                                 </span></span>
<span><span class="co">#&gt;  [5] "patent_year"                                                 </span></span>
<span><span class="co">#&gt;  [6] "patent_abstract"                                             </span></span>
<span><span class="co">#&gt;  [7] "patent_cpc_current_group_average_patent_processing_days"     </span></span>
<span><span class="co">#&gt;  [8] "withdrawn"                                                   </span></span>
<span><span class="co">#&gt;  [9] "patent_detail_desc_length"                                   </span></span>
<span><span class="co">#&gt; [10] "patent_earliest_application_date"                            </span></span>
<span><span class="co">#&gt; [11] "patent_num_foreign_documents_cited"                          </span></span>
<span><span class="co">#&gt; [12] "patent_num_times_cited_by_us_patents"                        </span></span>
<span><span class="co">#&gt; [13] "patent_num_total_documents_cited"                            </span></span>
<span><span class="co">#&gt; [14] "patent_num_us_applications_cited"                            </span></span>
<span><span class="co">#&gt; [15] "patent_num_us_patents_cited"                                 </span></span>
<span><span class="co">#&gt; [16] "patent_processing_days"                                      </span></span>
<span><span class="co">#&gt; [17] "patent_term_extension"                                       </span></span>
<span><span class="co">#&gt; [18] "gov_interest_statement"                                      </span></span>
<span><span class="co">#&gt; [19] "patent_uspc_current_mainclass_average_patent_processing_days"</span></span>
<span><span class="co">#&gt; [20] "wipo_kind"                                                   </span></span>
<span><span class="co">#&gt; [21] "inventor"                                                    </span></span>
<span><span class="co">#&gt; [22] "inventor_id"                                                 </span></span>
<span><span class="co">#&gt; [23] "inventor_name_first"                                         </span></span>
<span><span class="co">#&gt; [24] "inventor_name_last"                                          </span></span>
<span><span class="co">#&gt; [25] "inventor_gender_code"                                        </span></span>
<span><span class="co">#&gt; [26] "inventor_location_id"                                        </span></span>
<span><span class="co">#&gt; [27] "inventor_city"                                               </span></span>
<span><span class="co">#&gt; [28] "inventor_state"                                              </span></span>
<span><span class="co">#&gt; [29] "inventor_country"                                            </span></span>
<span><span class="co">#&gt; [30] "inventor_sequence"                                           </span></span>
<span><span class="co">#&gt; [31] "inv_city_state"                                              </span></span>
<span><span class="co">#&gt; [32] "assignee"                                                    </span></span>
<span><span class="co">#&gt; [33] "assignee_id"                                                 </span></span>
<span><span class="co">#&gt; [34] "assignee_type"                                               </span></span>
<span><span class="co">#&gt; [35] "assignee_individual_name_first"                              </span></span>
<span><span class="co">#&gt; [36] "assignee_individual_name_last"                               </span></span>
<span><span class="co">#&gt; [37] "assignee_organization"                                       </span></span>
<span><span class="co">#&gt; [38] "assignee_location_id"                                        </span></span>
<span><span class="co">#&gt; [39] "assignee_city"                                               </span></span>
<span><span class="co">#&gt; [40] "assignee_state"                                              </span></span>
<span><span class="co">#&gt; [41] "assignee_country"                                            </span></span>
<span><span class="co">#&gt; [42] "assignee_sequence"</span></span>
<span></span>
<span><span class="co"># where are unicycle patent applications concentrated?</span></span>
<span><span class="va">b62k</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">inv_city_state</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tally</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    pct <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    cumulative_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">pct</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">top_n</span><span class="op">(</span><span class="fl">10</span>, <span class="va">n</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">inv_city_state</th>
<th align="right">n</th>
<th align="right">pct</th>
<th align="right">cumulative_pct</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Santa Cruz, CA</td>
<td align="right">89</td>
<td align="right">3.335832</td>
<td align="right">3.335832</td>
</tr>
<tr class="even">
<td align="left">Chicago, IL</td>
<td align="right">77</td>
<td align="right">2.886057</td>
<td align="right">6.221889</td>
</tr>
<tr class="odd">
<td align="left">Bedford, NH</td>
<td align="right">73</td>
<td align="right">2.736132</td>
<td align="right">8.958021</td>
</tr>
<tr class="even">
<td align="left">Capitola, CA</td>
<td align="right">70</td>
<td align="right">2.623688</td>
<td align="right">11.581709</td>
</tr>
<tr class="odd">
<td align="left">San Francisco, CA</td>
<td align="right">68</td>
<td align="right">2.548726</td>
<td align="right">14.130435</td>
</tr>
<tr class="even">
<td align="left">Los Gatos, CA</td>
<td align="right">65</td>
<td align="right">2.436282</td>
<td align="right">16.566717</td>
</tr>
<tr class="odd">
<td align="left">معلمی نژاد, CA</td>
<td align="right">56</td>
<td align="right">2.098950</td>
<td align="right">18.665667</td>
</tr>
<tr class="even">
<td align="left">Roseau, MN</td>
<td align="right">37</td>
<td align="right">1.386807</td>
<td align="right">20.052474</td>
</tr>
<tr class="odd">
<td align="left">Madison, WI</td>
<td align="right">36</td>
<td align="right">1.349325</td>
<td align="right">21.401799</td>
</tr>
<tr class="even">
<td align="left">Colorado Springs, CO</td>
<td align="right">34</td>
<td align="right">1.274363</td>
<td align="right">22.676162</td>
</tr>
</tbody>
</table>
<p>And now that we are using the patentsview R package, we can do other interesting things like figuring out which of the applications in B62K have become patents. This can potentially change every time we run this query as more and more patent applications become issued patents and as new applications are classified with a subclass of B62K.</p>
<p>(Functions to do the post and clean below could be added to this package!)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Granted patent data is available from the API for 1976 onward,</span></span>
<span><span class="co"># as it was in the original version of the API.  With the new</span></span>
<span><span class="co"># version of the API, application data is also available for 2001 onward.</span></span>
<span></span>
<span><span class="co"># Here we'll make a query to the new publication endpoint with functionally</span></span>
<span><span class="co"># the same parameters as pv_post() makes to the patent endpoint</span></span>
<span><span class="va">application_query</span> <span class="op">&lt;-</span> <span class="fu">patentsview</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/patentsview/man/with_qfuns.html" class="external-link">with_qfuns</a></span><span class="op">(</span></span>
<span>  <span class="fu">and</span><span class="op">(</span></span>
<span>    <span class="fu">gte</span><span class="op">(</span>publication_date <span class="op">=</span> <span class="st">"2001-01-01"</span><span class="op">)</span>,</span>
<span>    <span class="fu">eq</span><span class="op">(</span>cpc_current.cpc_subclass_id <span class="op">=</span> <span class="st">"B62K"</span><span class="op">)</span>,</span>
<span>    <span class="fu">eq</span><span class="op">(</span>assignees.assignee_country <span class="op">=</span> <span class="st">"US"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fields_to_return</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"assignees"</span>, <span class="st">"inventors"</span>, <span class="st">"cpc_at_issue"</span><span class="op">)</span></span>
<span><span class="va">patent_applications</span> <span class="op">&lt;-</span> <span class="fu">patentsview</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/patentsview/man/search_pv.html" class="external-link">search_pv</a></span><span class="op">(</span><span class="va">application_query</span>, endpoint <span class="op">=</span> <span class="st">"publication"</span>, fields <span class="op">=</span> <span class="va">fields_to_return</span>, all_pages <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">patent_applications</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">publications</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1349</span></span>
<span><span class="va">unnested</span> <span class="op">&lt;-</span> <span class="fu">patentsview</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/patentsview/man/unnest_pv_data.html" class="external-link">unnest_pv_data</a></span><span class="op">(</span><span class="va">patent_applications</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">unnested</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ assignees   :'data.frame':    1363 obs. of  12 variables:</span></span>
<span><span class="co">#&gt;   ..$ document_number               : chr [1:1363] "20020148323" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee                      : chr [1:1363] "https://search.patentsvie"..</span></span>
<span><span class="co">#&gt;   ..$ assignee_id                   : chr [1:1363] "ceecf12f-afad-4fd3-9dfc-8"..</span></span>
<span><span class="co">#&gt;   ..$ assignee_type                 : chr [1:1363] "2" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_individual_name_first: chr [1:1363] NA ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_individual_name_last : chr [1:1363] NA ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_organization         : chr [1:1363] "L.H. Thomson Company, Inc"..</span></span>
<span><span class="co">#&gt;   ..$ assignee_location_id          : chr [1:1363] "ef5e39b0-16c7-11ed-9b5f-1"..</span></span>
<span><span class="co">#&gt;   ..$ assignee_city                 : chr [1:1363] "Macon" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_state                : chr [1:1363] "GA" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_country              : chr [1:1363] "US" ...</span></span>
<span><span class="co">#&gt;   ..$ assignee_sequence             : int [1:1363] 1 1 ...</span></span>
<span><span class="co">#&gt;  $ inventors   :'data.frame':    3398 obs. of  11 variables:</span></span>
<span><span class="co">#&gt;   ..$ document_number     : chr [1:3398] "20020148323" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor            : chr [1:3398] "https://search.patentsview.org:80/a"..</span></span>
<span><span class="co">#&gt;   ..$ inventor_id         : chr [1:3398] "fl:br_ln:thomson-9" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_name_first : chr [1:3398] "Brian" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_name_last  : chr [1:3398] "Thomson" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_gender_code: chr [1:3398] "M" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_location_id: chr [1:3398] "ed8ff011-16c7-11ed-9b5f-1234bde3cd0"..</span></span>
<span><span class="co">#&gt;   ..$ inventor_city       : chr [1:3398] "Warner Robins" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_state      : chr [1:3398] "GA" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_country    : chr [1:3398] "US" ...</span></span>
<span><span class="co">#&gt;   ..$ inventor_sequence   : int [1:3398] 1 0 ...</span></span>
<span><span class="co">#&gt;  $ cpc_at_issue:'data.frame':    4118 obs. of  9 variables:</span></span>
<span><span class="co">#&gt;   ..$ document_number: chr [1:4118] "20130092465" ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_sequence   : int [1:4118] 1 2 ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_class      : chr [1:4118] "https://search.patentsview.org:80/api/v1"..</span></span>
<span><span class="co">#&gt;   ..$ cpc_class_id   : chr [1:4118] "B62" ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_subclass   : chr [1:4118] "https://search.patentsview.org:80/api/v1"..</span></span>
<span><span class="co">#&gt;   ..$ cpc_subclass_id: chr [1:4118] "B62K" ...</span></span>
<span><span class="co">#&gt;   ..$ cpc_group      : chr [1:4118] "https://search.patentsview.org:80/api/v1"..</span></span>
<span><span class="co">#&gt;   ..$ cpc_group_id   : chr [1:4118] "B62K15/008" ...</span></span>
<span><span class="co">#&gt;   ..$ action_date    : chr [1:4118] "2013-04-18" ...</span></span>
<span><span class="co">#&gt;  $ publications:'data.frame':    1349 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   ..$ document_number: num [1:1349] 2e+10 ...</span></span>
<span></span>
<span><span class="co"># The new version of the API does not have publication_firstnamed_inventor_city</span></span>
<span><span class="co"># or publication_firstnamed_inventor_state so we'll getting them from</span></span>
<span><span class="co"># the first inventor (inventor_sequence of zero)</span></span>
<span></span>
<span><span class="co"># document_number is a string in inventors and numeric in publications</span></span>
<span><span class="co"># first inventor: min(unnested[["inventors"]]$inventor_sequence) is 0</span></span>
<span><span class="va">first_inventors</span> <span class="op">&lt;-</span> <span class="va">unnested</span><span class="op">[[</span><span class="st">"inventors"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">inventor_sequence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>inv_city_state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">inventor_city</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">inventor_state</span><span class="op">)</span>, <span class="va">inventor_country</span>, <span class="va">inventor_state</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>document_number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">document_number</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># document_number is a string in assignees and numeric in publications</span></span>
<span><span class="co"># first assignee: min(unnested[["assignees"]]$assignee_sequence) is 1</span></span>
<span><span class="va">first_assignees</span> <span class="op">&lt;-</span> <span class="va">unnested</span><span class="op">[[</span><span class="st">"assignees"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">assignee_sequence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>document_number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">document_number</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">publications</span> <span class="op">&lt;-</span> <span class="va">unnested</span><span class="op">[[</span><span class="st">"publications"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">first_inventors</span>, by <span class="op">=</span> <span class="st">"document_number"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">first_assignees</span>, by <span class="op">=</span> <span class="st">"document_number"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">publications</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1349   23</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">publications</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "document_number"                "inventor"                      </span></span>
<span><span class="co">#&gt;  [3] "inventor_id"                    "inventor_name_first"           </span></span>
<span><span class="co">#&gt;  [5] "inventor_name_last"             "inventor_gender_code"          </span></span>
<span><span class="co">#&gt;  [7] "inventor_location_id"           "inventor_city"                 </span></span>
<span><span class="co">#&gt;  [9] "inventor_state"                 "inventor_country"              </span></span>
<span><span class="co">#&gt; [11] "inventor_sequence"              "inv_city_state"                </span></span>
<span><span class="co">#&gt; [13] "assignee"                       "assignee_id"                   </span></span>
<span><span class="co">#&gt; [15] "assignee_type"                  "assignee_individual_name_first"</span></span>
<span><span class="co">#&gt; [17] "assignee_individual_name_last"  "assignee_organization"         </span></span>
<span><span class="co">#&gt; [19] "assignee_location_id"           "assignee_city"                 </span></span>
<span><span class="co">#&gt; [21] "assignee_state"                 "assignee_country"              </span></span>
<span><span class="co">#&gt; [23] "assignee_sequence"</span></span></code></pre></div>
<p>There’s more information on the patentsview R package <a href="https://github.com/ropensci/patentsview" class="external-link">here</a> (not yet updated for the new verion)</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>CC BY-SA</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing patentsview2</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nate Apathy <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Nate Apathy.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer>
</div>






  </body>
</html>
